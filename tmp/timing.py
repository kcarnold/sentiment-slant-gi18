# -*- coding: utf-8 -*-
"""
Created on Tue Jun 13 13:55:21 2017

@author: kcarnold
"""

import json
#%%
# Baseline
stats = '''
{"numInflight":0,"nosugg":[238,30,132,492,24,70,259,42,62,85,234,109,37,50,29,60,30,51,149,119,153,100,37,48,31,56,32,63,27,48,462,270,357,46,26,57,95,427,117,188,152,27,48,55,63,50,170,206,119,82,81,36,81,50,58,67,63,53,57,58,88,48,45,24,46,56,63,42,76,70,57,154,186,393,191,127,241,470,207,276,64,49,64,52,55,48,182,59,186,310,28,32,45,26,62,53,322,263,59,98,107,60,350,352,26,40,51,57,61,63,63,51,46,55,50,57,66,40,25,59,58,82,46,36,45,68,73,30,26,68,68,281,48,4,5,23,4,6,26,3,32,30,54,490,54,55,39,315,43,43,70,171,31,78,191,54,52,49,24,59,36,48,66,73,62,18,46,189,40,68,76,54,366,57,43,351,109,33,52,52,35,62,52,4,5,43,6,9,74,7,56,45,44,198,61,191,75,117,71,431,321,40,49,36,34,56,68,214,67,86,104,76,31,41,48,45,272,42,360,65,401,49,135,289,36,436,213,173,428,550,294,701,281,389,483,130,133,291,373,182,318,69,78,38,675,516,121,82,66,117,68,377,275,248,195,58,400,181,333,439,443,249,381,282,158,240,369,377,476,367,166,20,66,26,483,270,233,371,83,315,318,165,494,234,217,224,425,427,519,624,334,236,480,583,116,347,210,299,307,50,167,212,96,188,223,295,371,82,411,217,68,461,815,873,103,97,286,12,245,98,108,305,358,124,104,53,59,141,367,46,98,429,427,298,397,16,9,105,134,319,468,545,607,421,239,257,411,265,281,281,330,145,188,123,210,179,140,293,256,133,121,124,413,33,240,101,131,347,348,93,373,425,216,302,160,43,68,328,335,270,230,242,50,567,564,172,290,375,68,47,49,217,297,277,268,171,77,80,56,264],"diverse":[257,564,185,507,171,358,224,411,461,183,392,191,391,326,187,189,381,368,195,396,379,420,325,285,493,321,317,512,176,173,285,364,206,485,507,667,6,200,405,659,5,104,284,4,4,24,207,339,556,193,372,196,512,209,547,543,188,289,168,429,349,193,356,187,233,182,177,348,182,364,227,209,251,187,509,62,97,172,186,307,94,207,50,154,269,257,279,561,709,220,353,322,183,363,198,508,57,243,164,65,123,386,202,404,135,179,23,21,18,70,200,179,360,195,384,181,403,245,520,266,381,10,174,256,221,188,401,336,179,222,252,88,186,361,281,588,297,493,199,345,203,178,499,295,19,18,133,332,326,336,530,327,386,253,297,50,94,216,140,186,379,471,490,196,592,409,118,334,729,298,388,255,350,280,529,669,12,10,214,212,558,174,329,190,405,101,454,342,281,1040,457,317,911,929,342,378,201,458,451,424,528,313,88,366,636,303,497,5,516,349,461,330,327,228,432,553,488,323,322,254,426,540,407,411,272,184,180,256,305,366,246,258,512,322,168,204,67,455,59,337,4,8,420,193,188,509,511,487,313,249,328,189,248,449,536,539,199,497,517,94,364,329,107,6,55,188,317,378,460,325,199,72,112,137,96,125,478,65,84,69,268,399,352,348,262,364,436,681,211,428,309,453,345,495,328,516,353,335,303,464,290,289,533,415,368,465,368,220,115,374,423,339,431,581,295,338,216,482,786,399,492,339,403,383,139,515,380,365,369,366,267,573,259,495,330,492,369,336,253,354,504,311,286,582,570,346,225,135,486,129,473,563,441,421,349,186,513,310,106,87,614,559,320,432,438,446,232,371,204,408,511,473,335,66,350,96,346,423,876,418,501,113,103,247,94,287,185,209,258,353,94,201,373,293,253,96,96,69,107,215,360,273,106,257,375,137,143,359,212,75,190,131,15,184,141,516,49,241,264,176,109,297,161,356,228,198,169,716,388,231,427,227,208,359,116,597,222,470,238,90,92,175,411,236,336,195,419,333,231,143,479,479,224,210,176,191,246,241,290,390,409,348,222,255,31,406,181,30,8,11,184,100,130,49,255,231,328,344,166,233,676,676,198,326,214,307,597,597,228,266,373,264,273,168,229,437,341],"match":[262,176,365,237,199,380,184,364,183,351,171,357,460,531,440,178,388,194,232,356,353,308,203,393,171,509,328,192,378,172,344,381,272,167,339,344,311,699,543,261,294,452,221,409,305,41,174,524,181,33,364,200,425,610,233,373,24,229,252,314,54,93,178,341,279,262,209,400,253,244,491,180,368,200,230,418,164,480,289,570,177,382,184,130,275,208,395,207,518,460,901,909,690,379,381,202,379,308,175,352,210,414,76,263,245,326,36,329,354,193,523,316,37,211,221,384,213,203,556,327,394,313,479,225,305,216,387,460,220,428,63,110,307,273,516,132,44,233,179,354,188,362,251,275,428,390,436,173,362,164,344,380,170,352,190,362,319,523,187,192,387,201,168,253,185,361,193,383,26,44,190,366,104,244,307,178,357,411,327,260,277,493,511,215,468,179,375,195,382,212,229,481,355,312,383,210,417,482,307,291,526,207,209,383,133,312,210,460,182,347,275,177,368,110,169,325,289,524,38,81,224,523,264,53,320,42,271,64,318,612,234,27,197,366,203,348,398,478,700,190,484,588,551,191,374,91,87,178,650,598,41,70,232,534,192,385,190,174,389,174,356,4,3,2,3,2,53,67,47,359,316,195,481,345,294,248,291,219,292,47,278,210,402,194,450,64,271,28,202,175,347,219,537,236,375,460,307,82,365,309,176,355,215,229,405,209,275,191,252,225,91,412,201,384,140,175,188,568,350,543,543,170,424,332,438,718,52,75,162,348,169,375,174,224,250,473,199,467,174,421,214,518,204,342,184,345,191,341,218,184,255,276,176,350,192,367,267,276,292,414,175,355,252,209,185,504,238,364,312,169,355,409,331,182,369,34,60,156,319,173,364,187,417,230,302,305,617,434,192,184,362,197,248,202,306,208,379,196,377,330,417,207,268,395,166,200,679,509,312,317,330,426,667,568,197,379,387,253,250,240,216,216,577,482,582,490,247,341,266,271,196,303,81,126,287,586,310,201,346,212,353,293,44,91,290,428,191,345,584,562,590,40,91,216,366,255,317,269,330,423,337,327,886,370,229,38,81,523,540,199,418,546,216,460,303,284,348,295,234,191,353,60,224,136,414,272,347,272,342,771,1019,1041,1042,170,277,604,606,607,836,938,940,403,241,836,926,950,917,191,56,216,60,314,466,489,257,354,447,253,288,402,47,61,187,6,174,274,293,44,172,253,459,319,322,391,450,201,203,365,442,444,338,341,661,738,740,759,368,424,257,460,456,187,528,529,38,75,336,237,238,190,89,224,67,248,179,313,317,413,589,636,658,303,336,437,507,504,191,423,499,202,152,151,242,169,270,393,173,192,7,403,519,365,366,17,312,315,330,463,331,245,326,382,464,469,76,325,466,466,241,243,246,386,434,128,444,531,243,292,174,68,356,415,420,180,481,491,326,341,356,65,325,309,309,78,197,471,470,74,188,7,225,429,162,162,223,211,371,439,540,130,223,303,332,394,205,334,99,99,152,367,401,419,199,7,333,355,256,318,179,179,184,260,75,366,327,329,35,59,178,296,320,399,500,192,198,510,510,75,321,325,346,350,351,342,359,183,291,302,186,327,387,256,319,255,452,301,301,120,75,138,182,49,244,408,408,243,344,65,196,492,496,448,541,607,609,201,259,277,328,302,302,170,174,165,175,325,25,301,333,408,486,180,232,435,435,311,376,377,167,272,188,76,257,455,457,351,97,400,419,443,246,321,343,346,245,315,367,559,139,226,186,345,345,230,249,462,465,235,332,333,92,352,296,349,247,317,199,194,321,342,169,302,369,396,394,457,224,318,340,147,259,348,198,318,339,187,232,269,485,487,338,428,277,487,486,190,77,83,246,276,481,68,208,219,220,101,217,66,186,64,343,316,316,280,360,302,396,698,717,98,74,170,355,429,518,519,348,132,676,679,254,347,348,343,223,177,271,43,113,203,95,184,121,428,101,333,352,210,210,66,556,627,630,339,339,353,353,337,338,367,351,355,335,496,235,331,407,515,516,520,218,352,548,547,174,437,466,292,395,351,363,280,363,216,352,298,415,652,699,702,254,28,264,364,365,281,353,387,330,339,481,147,150,238,137,485,583,111,206,417,275,285,385,371,282,514,220,666,671,669,464,514,516,519,372,374,338,192,189,285,401,401,459,463,207,178,280,336,440,582,217,254,348,333,335,191,389,343,383,439,320,433,533,535,533,582,317,465,470,333,434,498,646,694,786,300,282,199,392,494,234,342,295,338,209,403,502,502,385,240,373,511,518,416,518,234,473,477,267,366,383,434,363,267,268,367,379,263,272,69,223,384,481,485,422,422,520,272,363,423,516,520,233,368,371,268,470,485,257,271,326,85,340,341,341,394,161,319,418,219,230,390,392,495,285,96,399,494,469,518,286,334,219,353,314,301,452,160,257,285,286,223,316,233,332,136,384,385,441,566,566,663,667,223,391,391,279,326,425,196,192,342,492,213,325,326,424,373,609,273,524,625,623,210,345,427,320,288,485,584,202,391,198,387,486,224,419,418,512,614,665,186,587,589,593,788,212,296,445,204,205,336,136,504,503,603,603,209,19,369,207,187,317,366,187,412,417,616,114,114,49,169,267,465,466,562,209,153,215,195,366,369,371,205,134,339,340,311,314,285,292,383,485,499,189,384,436,200,224,225,228,319,347,231,293,70,269,272,80,111,114,208,413,511,202,129,219,179,413,473,195,195,335,336,139,140,251,133,228,69,252,351,386,461,464,197,263,263,98,183,426,315,315,189,124,710,809,873,880,361,501,268,346,96,176,254,132,152,346,264,365,236,348,70,101,330,342,190,159,372,288,286,368,100,358,93,274,339,425,512,140,254,264,290,365,367,161,356,168,966,968,972,288,186,427,231,329,198,262,306,396,480,579,583,308,368,205,198,249,206,265,359,207,266,103,123,320,419,470,514,594,217,759,807,968,359,972,458,419,409,338,414,429,290,247,479,290,181,409,96,347,409,281,330,278,377,292,293,307,351,268,229,347,54,87,663,674,291,373,20,266,27,325,425,22,23,6,323,364,307,450,447,250,45,67,328,328,222,332,327,373,413,125,221,157,314,316,490,563,565,286,313,273,356,121,227,347,261,266,192,310]}
'''
#%%
# Lots of samples with
#  - parallel sentiment classification, chunksize=32
#  - printing disabled

stats = '''
{"numInflight":0,"nosugg":[44,64,74,33,62,120,28,46,47,64,27,61,260,36,60,31,51,93,63,83,55,85,50,30,58,62,30,145,102,30,138,87,33,54,227,146,61,66,50,53,47,84,123,87,54,99,40,85,135,80,77,68,106,94,275,146,242,38,81,340,36,80,37,82,73,58,111,66,112,62,110,28,50,58,147,30,55,28,78,30,51,39,57,86,122,95,131,29,47,130,26,62,33,51,146,42,28,58,83,29,47,27,52,29,47,108,26,42,121,121,29,63,29,48,89,159,29,47,31,51,43,58,40,60,41,48,53,113,73,128,111,199,83,293,141,4,4,2,2,3,25,61,58,28,67,47,74,31,56,40,70,46,63,211,73,33,53,45,85,26,24,52,34,63,27,44,70,51,65,47,98,46,64,51,53,113,81,77,45,83,183,179,104,99,107,64,67,104,75,81,230,79,82,183,529,78,122,52,95,77,73,70,51,61,77,23,64,80,63,71,37,83,53,50,221,69,52,230,65,48,88,193,279,237,195,176,49,4,41,37,42,4,188,73,69,66,37,143,85,63,59,214,199,67,112,59,65,54,83,40,85,84,93,65,67,81,126,101,76,78,135,177,31],"diverse":[370,433,160,470,241,232,364,162,308,236,393,189,168,268,451,155,398,359,376,203,158,280,233,141,304,240,153,144,285,122,121,258,432,88,172,9,8,141,140,151,150,7,161,173,456,224,155,296,141,278,132,282,55,286,227,400,96,236,322,175,317,149,284,270,322,153,287,45,168,255,271,430,266,126,254,189,279,151,209,268,48,47,143,273,6,34,156,369,104,232,132,177,163,66,109,160,151,290,291,162,166,266,303,167,330,372,178,294,342,141,176,255,280,422,423,131,129,140,233,28,25,91,236,108,32,63,263,403,40,128,212,184,274,233,140,285,263,98,228,173,459,18,17,34,53,249,281,279,360,241,175,219,147,298,449,181,225,35,171,170,313,146,278,142,272,408,343,156,462,538,468,114,210,102,158,148,274,35,292,363,171,75,324,371,291,659,156,298,169,315,127,271,360,149,285,177,141,263,268,537,260,326,133,256,252,153,287,125,200,136,260,186,424,138,156,382,162,275,168,143,368,155,285,133,373,140,282,257,261,369,243,471,51,151,214,161,303,155,379,155,143,399,160,182,404,119,63,67,135,139,459,141,138,174,319,171,169,208,163,233,304,249,292,195,62,105,138,183,220,84,223,45,80,245,739,743,310,355,182,274,142,294,231,272,59,204,238,281,344,437,140,205,306,394,273,175,126,295,409,210,200,302,296,250,132,257,269,491,83,183,109,129,41,177,122,244,164,416,261,115,165,104,240,170,323,278,475,206,193,342,258,302,93,230,590,617,334,262,307,181,185,128,183,162,311,504,341,162,161,200,198,254,337,381,793,403,532,184,217,171,314,450,56,61,328,288,333,310,372,256,145,333,106,444,233,41,149,164,346,124,259,361,416,219,349,296,444,585,197,247,155,398,380,202,202,151,184,140,183,204,283,70,67,47,59,141,286,152,189,159,154,146,142,22,161,282,322,309,355,287,325,130,289,7,6],"match":[144,491,374,327,355,312,499,667,364,311,145,274,12,8,6,124,165,141,270,71,122,380,127,236,360,257,137,275,467,169,147,287,154,143,284,53,150,118,242,118,251,171,299,283,128,262,123,289,148,313,98,131,278,141,272,358,334,547,176,148,178,147,270,142,280,143,396,266,261,406,34,147,132,267,146,302,147,276,249,191,491,260,241,202,382,144,156,293,203,141,184,239,195,301,661,426,173,299,159,301,233,148,291,249,197,398,128,298,300,245,269,391,244,275,319,133,190,366,152,299,172,299,164,298,183,299,250,557,464,156,315,238,409,257,289,221,567,541,350,431,165,142,295,153,393,248,97,131,236,140,280,172,297,64,77,123,170,151,275,153,155,294,178,124,266,114,161,143,479,225,39,172,38,55,126,261,275,137,65,15,289,286,426,119,232,35,52,142,267,128,261,47,165,140,115,272,234,157,274,142,271,142,244,278,191,246,280,152,285,115,241,176,304,141,256,135,163,385,201,125,260,239,189,139,348,145,137,275,144,175,303,141,366,253,257,212,418,474,147,112,146,134,223,142,287,118,177,48,79,139,272,133,262,152,131,328,51,176,126,250,275,183,547,292,177,302,46,74,127,267,4,4,4,4,3,31,68,134,262,112,168,340,340,386,223,191,196,225,256,126,263,330,218,262,244,251,196,248,109,162,254,192,189,175,174,319,196,423,180,181,267,312,332,146,191,139,486,382,348,57,190,174,272,52,88,146,233,317,158,251,259,304,486,447,531,332,272,310,196,151,284,203,139,332,60,125,265,202,247,118,293,150,399,221,233,289,96,140,251,198,147,175,346,344,79,124,195,375,181,362,166,211,52,97,391,364,200,486,114,245,177,288,261,427,238,316,280,324,230,273,378,313,268,275,114,282,146,290,68,113,150,400,259,245,234,314,171,306,227,307,222,277,239,244,385,260,266,285,290,259,415,653,390,367,243,238,319,172,309,186,472,207,175,318,237,282,111,158,291,177,315,164,108,182,188,143,283,144,259,145,286,154,128,273,48,72,292,588,519,789,261,391,143,153,257,386,168,138,193,147,190,179,295,13,154,294,128,256,38,176,128,245,149,280,32,55,216,202,352,129,381,169,131,367,141,288,152,295,42,176,130,382,207,143,279,135,231,143,294,127,235,158,136,252,364,177,139,52,115,135,255,317,431,50,68,24,149,275,221,269,592,319,254,217,385,150,122,297,132,260,144,273,149,384,125,215,355,204,179,156,308,144,369,378,127,299,201,140,442,411,194,244,277,550,177,162,294,154,272,366,327,312,130,228,149,291,108,237,256,247,274,99,137,144,299,157,201,55,82,141,310,6,31,37,62,7,39,125,233,156,47,155,293,194,345,247,357,122,133,260,37,160,128,247,139,267,68,27,100,131,384,242,231,388,239,122,163,230,42,81,172,95,296,116,230,237,27,53,43,65,34,61,53,138,475,331,33,158,156,278,144,311,259,361,149,276,96,24,139,139,365,34,72,128,263,75,151,286,306,151,138,269,146,261,185,331,254,173,156,165,147,175,147,373,220,274,232,189,441,131,260,136,270,130,258,320,353,310,148,274,241,293,256,291,91,231,277,158,521,219,274,210,295,135,286,151,295,283,298,294,618,249,290,635,585,360,157,297,143,380,274,170,315,203,156,354,337,196,173,216,296,282,277,427,22,156,190,187,209,277,357,274,276,418,213,278,601,582,682,68,107,219,232,420,159,147,293,67,112,196,240,237,149,284,152,219,301,172,168,110,154,182,136,280,250,287,375,312,499,722,343,297,329,142,249,185,183,142,385,239,98,97,226,280,356,174,155,278,240,344,288,389,232,302,272,399,158,303,304,166,263,164,209,296,303,657,420,156,226,72,215,241,273,420,141,404,60,83,167,227,52,74,145,272,145,319,160,283,143,239,208,380,53,203,43,160,57,82,137,122,282,155,150,155,280,172,306,397,130,267,5,38,64,137,267,138,375,225,28,56,166,253,392,110,221,372,242,218,542,177,7,36,138,286,141,140,277,136,293,159,246,46,186,159,324,99,229,165,140,273,160,114,262,142,269,128,276,172,310,120,260,152,169,298,135,277,191,226,36,165,42,121,233,132,254,255,35,179,34,170,198,195,175,273,257,175,420,218,218,121,304,142,221,314,242,328,316,310,407,276,72,118,259,124,121,150,359,313,159,612,488,705,323,96,100,255,296,249,294,264,309,387,348,432,260,305,295,481,477,315,242,265,267,216,300,143,190,173,328,299,837,750,699,781,693,300,284,333,540,501,589,179,180,76,222,164,411,153,138,228,188,146,285,167,311,212,255,157,133,307,247,338,178,159,299,173,356,154,287,149,407,175,83,163,164,551,324,221,196,323,50,203,200,144,196,206,254,258,398,243,423,197,53,83,65,61,179,325,247,395,482,147,384,217,310,142,289,162,206,44,40,148,435,220,220,200,350,190,621,217,316,332,159,404,150,340,53,332,288,44,79,180,173,356,227,390,443,689,242,300,365,488,62,201,68,164,184,619,497,322,198,50,195,191,329,424,392,573,230,313,165,404,318,180,368,147,286,56,157,302,250,296,241,429,206,224,310,143,286,175,219,175,225,6,56,252,541,414,409,454,323,369,140,169,195,444,252,339,476,207,183,375,163,303,42,195,153,296,201,157,210,250,295,186,276,228,263,20,58,281,311,420,501,146,291,138,283,179,328,285,317,493,560,161,405,170,6,141,11,9,211,303,165,309,45,223,265,369,29,28,176,322,167,177,324,116,164,129,211,234,273,161,255,210,361,308,55,63,185,162,224,60,105,186,325,237,299,101,194,313,367]}
'''
#%%
# Optimized.
stats = '''
{"numInflight":0,"nosugg":[319,159,19,40,47,111,26,42,24,37,22,43,62,80,21,46,226,121,27,59,29,40,22,32,99,30,24,37,38,34,56,69,34,49,21,26,32,49,56,58,76,199,132,20,36,111,26,38,59,65,40,25,41,32,45,65,66,27,43,59,98,20,31,32,21,39,98,30,41,91,108,49,75,59,33,62,30,53,198,55,21,33,22,36,26,43,41,55,22,34,184,82,216,89,25,36,77,119,20,32,21,47,109,21,32,21,53,21,34,33,49,34,91,70,67,50,47,106,102,42,83,109,116,112,64,60,51,49,71,68,165,48,61,51,4,2,3,2,3,3,17,30,141,534,73,97,20,32,34,51,30,59,33,20,45,28,40,43,89,29,43,22,29,47,37,53,53,21,33,21,59,53,35,47,20,30,46,38,159,88,84,64,60,74,69,69,65,72,69,100,80,49,59,38,67,73,45,42,64,67,48,44,40,3,47,43,47,68,63,64,39,84,70,68,67,112,66,73,80,39,138,68,63,57,57,84,81,73,71,54,30,74,42,113,2,2,22,17,21,37,19,31,21,34,4,37,34,26,101,22,47,39,34,24,42,51,66,77,28,59,49,18,41,19,36,98,25,60,23,32,43,21,57,15,27,92,56,22,70,60,75,127,43,63,62,109,60,35,128,33,41,36,38,65,61,65,62,54,76,71,23,52,112,60,104,134,51,47,48,45,70,67,69,78,51,47,40,39,101,128,39,50,78,75,54,138,386,65,61,46,89,91,53,50,50,180,176,75,64,83,84,182,77,75,83,79,65,61,78,75,61,57,39,86,74,69,52,91,44,89,95,62,65,61,57,83,84,78,73,74,117,41,37,63,43,44,60,54,47,70,90,71,71,51,91,85,86,114,118,119,288,26,49,50,47,89,92,47,49,50,159,79,47,95,104,63,41,212,212,34,36,49,48,43,43,56,56,41,57,57,231,185,56,62,163,200,78,170,72,72,17,87,38,128,6,16,15,97,4,72,177,43,37,116,143,146,121,38,28,53,28,28,55,36,47],"diverse":[207,303,174,352,96,201,104,232,119,233,130,225,110,340,129,106,149,105,221,144,257,128,226,34,225,208,149,127,332,262,422,113,205,6,129,50,12,66,275,281,289,241,140,5,4,5,115,259,192,124,278,111,239,147,352,26,128,115,219,125,224,118,223,320,675,104,155,67,122,69,91,208,134,116,218,154,150,102,307,208,148,108,137,110,450,121,227,105,204,195,183,120,292,60,100,7,44,44,6,33,79,209,65,30,69,268,225,68,81,68,115,227,147,353,237,213,398,195,265,167,348,127,230,31,147,242,4,137,135,126,234,13,125,239,18,17,125,239,40,140,76,302,383,107,202,135,167,127,129,209,110,210,191,297,55,244,115,143,249,116,209,87,7,6,178,6,4,280,95,172,83,239,113,213,262,438,111,55,354,126,240,246,6,117,145,649,95,199,119,275,139,61,192,275,322,111,442,115,326,105,128,239,64,170,289,200,189,299,119,222,115,278,101,202,7,7,136,283,102,202,221,305,106,228,107,127,325,125,196,160,345,133,252,100,96,239,225,124,327,108,251,166,28,77,127,269,620,141,200,61,84,44,80,41,66,64,90,141,236,49,123,225,176,135,267,229,158,273,142,184,130,268,212,238,272,112,208,148,278,382,127,209,152,196,229,413,201,187,231,177,173,287,143,150,219,60,69,126,126,220,116,221,116,211,124,337,145,186,107,211,618,722,101,215,248,173,166,104,192,170,370,116,136,137,45,173,40,61,186,318,115,233,255,133,328,106,202,45,152,120,225,93,145,193,116,105,293,119,214,112,80,177,134,108,357,119,209,68,213,43,50,77,306,112,245,334,172,325,121,259,114,152,258,313,51,48,104,232,115,245,233,95,196,133,233,80,85,122,150,39,40,35,214,257,46,99,61,145,37,82,140,243,167,63,69,175,120,152,75,263,149,103,196,101,123,169,128,167,250,597,162,120,234,203,223,110,220,119,212,130,253,99,210,233,101,100,119,119,6,116,100,155,275,158,119,250,118,217,120,365,245,40,77,122,269,128,283,84,110,158,484,120,198,46,134,104,203,99,204,138,381,218,142,281,130,347,148,125,216,92,325,135,110,151,253,101,195,106,99,184,91,257,197,105,211,156,79,144,134,148,331,171,213,246,231,276,260,258,147,63,97,230,275,104,197,167,149,485,346,251,198,244,119,260,201,173,318,185,246,278,103,203,7,39,184,181,211,137,228,38,133,96,195,241,53,59,155,214,255,189,234,233,279,148,241,203,353,24,23,107,289,109,83,82,114,220,150,95,182,217,134,289,325,43,52,181,104,151,110,20,202,105,61,111,9,119,96,214,146,166,63,13,94,114,72,85,93,135,134,11,225,268,237,122,190,147,129,114,208,44,6,30,26,10,231,237,149,183,190,218,133,211,135,96,195,195,299,132,40,100,27,196,236,46,159,185,130,181,113,32,73,24,89,131,104,186,235,204,86,65,68,233,173,148,211,29,430,134,158,111,7,6],"match":[95,193,191,104,384,330,350,100,222,100,191,118,205,96,191,104,200,103,181,98,212,96,177,103,278,155,98,190,176,184,135,215,390,138,120,186,39,105,234,120,221,125,216,139,139,249,204,115,255,283,129,263,113,133,237,8,96,117,241,56,102,205,170,131,100,115,123,228,246,107,219,143,265,356,331,216,112,229,113,233,105,202,199,124,196,128,51,125,239,65,107,117,220,102,205,41,63,115,211,100,209,272,268,151,66,260,111,228,114,348,423,162,326,468,127,166,146,278,51,171,196,127,221,109,216,142,348,147,271,110,229,12,235,226,509,257,290,106,275,143,254,130,330,196,101,216,130,71,262,250,240,123,231,70,191,193,117,209,242,224,335,306,360,147,283,132,243,231,90,200,98,132,255,336,100,222,201,312,109,193,112,239,96,212,141,127,214,141,254,99,199,185,325,86,101,250,98,130,222,201,263,48,69,95,127,115,330,268,97,200,28,41,24,109,99,209,282,232,161,111,211,116,217,108,226,335,321,331,326,46,51,6,5,17,16,92,191,113,214,7,84,103,105,227,136,189,304,117,226,101,210,114,214,102,202,103,42,204,96,196,118,161,80,115,96,194,123,262,113,226,132,228,42,54,107,217,101,143,113,199,151,298,132,238,31,61,151,162,288,108,312,219,25,53,71,27,214,243,252,74,185,168,366,144,277,130,263,144,255,113,230,285,262,393,485,140,176,109,211,118,141,128,246,149,274,113,217,117,240,350,114,159,143,132,278,103,210,108,298,206,123,234,190,143,160,44,382,131,300,178,372,199,209,345,199,164,353,603,26,138,104,192,341,221,118,229,143,137,134,254,129,239,51,133,162,177,156,292,132,251,45,60,93,227,109,172,34,68,113,222,27,122,31,70,41,117,253,36,59,207,134,244,342,287,330,122,241,29,104,29,60,96,198,75,92,285,160,102,205,95,71,175,26,112,101,266,170,185,327,484,270,446,98,187,129,225,102,193,146,300,157,102,197,290,189,104,142,102,208,103,126,230,163,263,126,240,129,224,128,90,191,159,113,227,135,149,122,257,102,180,124,172,304,422,456,134,224,28,160,175,109,220,129,173,177,228,282,47,194,123,276,120,85,239,123,214,144,250,101,28,162,97,221,143,363,263,227,315,631,442,258,141,259,253,329,401,593,159,107,297,174,117,138,28,47,104,199,116,240,156,190,323,320,258,124,24,57,119,266,342,136,246,166,153,300,576,804,42,52,133,236,203,95,325,241,100,36,112,133,220,100,213,125,285,215,56,254,343,250,231,100,192,113,202,110,221,123,175,76,194,156,290,110,133,137,244,212,484,127,336,172,133,250,244,234,364,176,22,42,47,141,136,161,115,216,156,256,114,213,97,188,59,197,21,165,261,238,379,144,98,283,183,53,79,114,292,220,134,101,216,106,444,328,240,30,48,256,113,212,221,328,255,475,110,205,102,266,118,213,99,189,117,139,119,213,104,216,135,251,192,76,101,42,61,102,114,259,140,191,87,117,222,125,222,26,46,15,39,124,325,262,101,214,196,362,416,513,217,125,186,88,211,145,273,333,64,172,96,171,104,198,336,158,276,28,124,104,237,113,231,114,213,97,251,156,151,284,127,237,56,273,132,331,349,170,124,301,118,214,148,38,245,127,256,100,202,125,231,126,216,330,131,224,63,107,104,70,92,103,104,198,85,180,83,79,105,127,220,201,214,261,226,270,100,218,259,152,90,185,224,219,152,295,51,96,226,236,330,323,152,446,345,293,169,269,163,264,239,357,191,409,214,269,166,269,121,58,154,181,239,225,318,335,275,333,472,184,247,115,159,207,253,91,233,214,301,128,317,194,107,128,132,148,36,127,32,131,250,98,121,137,271,219,67,43,172,173,291,208,164,305,169,209,39,185,125,110,310,182,151,114,224,142,253,142,131,253,112,285,28,216,172,149,289,152,38,242,186,130,237,141,266,101,138,105,214,307,168,199,25,53,181,266,145,281,102,231,113,97,204,72,128,95,270,84,104,200,186,302,336,444,96,63,207,109,203,99,242,260,38,120,125,231,104,198,119,267,36,211,173,140,234,55,159,232,53,79,125,254,120,153,195,250,221,108,237,145,235,93,138,267,28,26,46,65,161,130,260,109,97,258,98,233,178,114,220,54,66,31,139,104,211,132,228,39,126,276,120,129,122,222,208,227,351,360,219,184,164,338,344,116,216,175,294,96,290,150,372,466,124,168,52,255,157,199,188,234,191,142,245,148,27,115,131,129,146,239,240,168,197,99,276,109,207,116,173,238,284,112,114,131,169,105,203,178,272,124,196,323,257,85,82,115,216,143,134,184,137,279,193,238,140,342,165,134,271,146,276,186,232,55,52,188,381,208,184,119,164,133,189,236,91,184,105,250,133,157,240,188,233,132,129,101,198,180,277,81,62,200,80,125,106,212,114,246,104,302,105,239,70,65,162,307,147,219,252,111,159,51,197,227,272,93,139,194,290,162,300,317,387,138,223,183,282,109,314,175,139,165,223,98,194,188,232,104,206,99,293,193,99,289,229,246,476,343,145,294,245,229,276,110,265,109,234,170,172,297,105,202,161,45,66,98,158,197,332,25,43,56,75,105,202,105,133,246,28,151,81,176,296,136,161,6,25,96,208,114,219,42,41,68,118,215,113,140,107,316,209,137,232,20,128,96,197,53,170,105,41,59,271,310,229,143,362,99,290,168,128,223,36,200,176,353,122,270,117,227,291,200,307,123,223,110,156,296,134,232,116,218,88,192,131,256,47,95,188,122,193,313,343,115,374,170,127,376,257,193,101,202,99,334,202,243,260,101,187,22,122,103,219,19,134,237,147,284,133,232,118,251,99,256,355,101,184,26,145,130,100,194,6,4,58,75,30,102,231,160,229,7,24,79,116,217,43,42,166,311,21,60,101,202,121,172,325,409,96,189,113,204,130,130,222,147,105,203,189,234,104,300,194,137,338,151,205,248,247,44,88,205,188,234,109,206,118,212,88,142,59,59,223,259,110,206,38,38,150,195,125,112,220,222,268,183,123,89,260,203,249,159,203,109,206,118,212,170,261,72,70,176,267,120,261,123,142,139,127,322,341,242,390,232,276,130,274,167,312,187,277,107,152,152,54,160,196,241,104,297,208,230,106,184,87,124,168,164,141,216,261,175,229,181,416,375,244,223,172,317,250,301,117,213,220,264,150,182,151,252,206,175,118,254,86,119,169,64,162,157,202,130,268,315,291,361,227,226,259,106,241,78,59,55,62,58,214,106,226,84,214,110,217,109,237,136,227,188,225,169,169,205,303,323,179,128,191,68,121,223,226,75,79,151,200,199,106,114,106,267,194,225,195,107,83,168,182,202,115,260,187,203,209,115,255,294,50,237,267,184,23,21,179,229,197,230,433,165,129,287]}
'''
#%%
import pandas as pd
statsx = pd.DataFrame([dict(type=typ, val=val) for typ, vals in json.loads(stats).items() if isinstance(vals, list) for val in vals])
print(len(statsx))
import seaborn as sns
sns.violinplot(x='type', y='val', data=statsx)
statsx.groupby('type').describe()
#%%
statsx.groupby('type').sem()