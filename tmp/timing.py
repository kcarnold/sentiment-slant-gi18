# -*- coding: utf-8 -*-
"""
Created on Tue Jun 13 13:55:21 2017

@author: kcarnold
"""

import json
#%%
# Baseline
stats = '''
{"numInflight":0,"nosugg":[238,30,132,492,24,70,259,42,62,85,234,109,37,50,29,60,30,51,149,119,153,100,37,48,31,56,32,63,27,48,462,270,357,46,26,57,95,427,117,188,152,27,48,55,63,50,170,206,119,82,81,36,81,50,58,67,63,53,57,58,88,48,45,24,46,56,63,42,76,70,57,154,186,393,191,127,241,470,207,276,64,49,64,52,55,48,182,59,186,310,28,32,45,26,62,53,322,263,59,98,107,60,350,352,26,40,51,57,61,63,63,51,46,55,50,57,66,40,25,59,58,82,46,36,45,68,73,30,26,68,68,281,48,4,5,23,4,6,26,3,32,30,54,490,54,55,39,315,43,43,70,171,31,78,191,54,52,49,24,59,36,48,66,73,62,18,46,189,40,68,76,54,366,57,43,351,109,33,52,52,35,62,52,4,5,43,6,9,74,7,56,45,44,198,61,191,75,117,71,431,321,40,49,36,34,56,68,214,67,86,104,76,31,41,48,45,272,42,360,65,401,49,135,289,36,436,213,173,428,550,294,701,281,389,483,130,133,291,373,182,318,69,78,38,675,516,121,82,66,117,68,377,275,248,195,58,400,181,333,439,443,249,381,282,158,240,369,377,476,367,166,20,66,26,483,270,233,371,83,315,318,165,494,234,217,224,425,427,519,624,334,236,480,583,116,347,210,299,307,50,167,212,96,188,223,295,371,82,411,217,68,461,815,873,103,97,286,12,245,98,108,305,358,124,104,53,59,141,367,46,98,429,427,298,397,16,9,105,134,319,468,545,607,421,239,257,411,265,281,281,330,145,188,123,210,179,140,293,256,133,121,124,413,33,240,101,131,347,348,93,373,425,216,302,160,43,68,328,335,270,230,242,50,567,564,172,290,375,68,47,49,217,297,277,268,171,77,80,56,264],"diverse":[257,564,185,507,171,358,224,411,461,183,392,191,391,326,187,189,381,368,195,396,379,420,325,285,493,321,317,512,176,173,285,364,206,485,507,667,6,200,405,659,5,104,284,4,4,24,207,339,556,193,372,196,512,209,547,543,188,289,168,429,349,193,356,187,233,182,177,348,182,364,227,209,251,187,509,62,97,172,186,307,94,207,50,154,269,257,279,561,709,220,353,322,183,363,198,508,57,243,164,65,123,386,202,404,135,179,23,21,18,70,200,179,360,195,384,181,403,245,520,266,381,10,174,256,221,188,401,336,179,222,252,88,186,361,281,588,297,493,199,345,203,178,499,295,19,18,133,332,326,336,530,327,386,253,297,50,94,216,140,186,379,471,490,196,592,409,118,334,729,298,388,255,350,280,529,669,12,10,214,212,558,174,329,190,405,101,454,342,281,1040,457,317,911,929,342,378,201,458,451,424,528,313,88,366,636,303,497,5,516,349,461,330,327,228,432,553,488,323,322,254,426,540,407,411,272,184,180,256,305,366,246,258,512,322,168,204,67,455,59,337,4,8,420,193,188,509,511,487,313,249,328,189,248,449,536,539,199,497,517,94,364,329,107,6,55,188,317,378,460,325,199,72,112,137,96,125,478,65,84,69,268,399,352,348,262,364,436,681,211,428,309,453,345,495,328,516,353,335,303,464,290,289,533,415,368,465,368,220,115,374,423,339,431,581,295,338,216,482,786,399,492,339,403,383,139,515,380,365,369,366,267,573,259,495,330,492,369,336,253,354,504,311,286,582,570,346,225,135,486,129,473,563,441,421,349,186,513,310,106,87,614,559,320,432,438,446,232,371,204,408,511,473,335,66,350,96,346,423,876,418,501,113,103,247,94,287,185,209,258,353,94,201,373,293,253,96,96,69,107,215,360,273,106,257,375,137,143,359,212,75,190,131,15,184,141,516,49,241,264,176,109,297,161,356,228,198,169,716,388,231,427,227,208,359,116,597,222,470,238,90,92,175,411,236,336,195,419,333,231,143,479,479,224,210,176,191,246,241,290,390,409,348,222,255,31,406,181,30,8,11,184,100,130,49,255,231,328,344,166,233,676,676,198,326,214,307,597,597,228,266,373,264,273,168,229,437,341],"match":[262,176,365,237,199,380,184,364,183,351,171,357,460,531,440,178,388,194,232,356,353,308,203,393,171,509,328,192,378,172,344,381,272,167,339,344,311,699,543,261,294,452,221,409,305,41,174,524,181,33,364,200,425,610,233,373,24,229,252,314,54,93,178,341,279,262,209,400,253,244,491,180,368,200,230,418,164,480,289,570,177,382,184,130,275,208,395,207,518,460,901,909,690,379,381,202,379,308,175,352,210,414,76,263,245,326,36,329,354,193,523,316,37,211,221,384,213,203,556,327,394,313,479,225,305,216,387,460,220,428,63,110,307,273,516,132,44,233,179,354,188,362,251,275,428,390,436,173,362,164,344,380,170,352,190,362,319,523,187,192,387,201,168,253,185,361,193,383,26,44,190,366,104,244,307,178,357,411,327,260,277,493,511,215,468,179,375,195,382,212,229,481,355,312,383,210,417,482,307,291,526,207,209,383,133,312,210,460,182,347,275,177,368,110,169,325,289,524,38,81,224,523,264,53,320,42,271,64,318,612,234,27,197,366,203,348,398,478,700,190,484,588,551,191,374,91,87,178,650,598,41,70,232,534,192,385,190,174,389,174,356,4,3,2,3,2,53,67,47,359,316,195,481,345,294,248,291,219,292,47,278,210,402,194,450,64,271,28,202,175,347,219,537,236,375,460,307,82,365,309,176,355,215,229,405,209,275,191,252,225,91,412,201,384,140,175,188,568,350,543,543,170,424,332,438,718,52,75,162,348,169,375,174,224,250,473,199,467,174,421,214,518,204,342,184,345,191,341,218,184,255,276,176,350,192,367,267,276,292,414,175,355,252,209,185,504,238,364,312,169,355,409,331,182,369,34,60,156,319,173,364,187,417,230,302,305,617,434,192,184,362,197,248,202,306,208,379,196,377,330,417,207,268,395,166,200,679,509,312,317,330,426,667,568,197,379,387,253,250,240,216,216,577,482,582,490,247,341,266,271,196,303,81,126,287,586,310,201,346,212,353,293,44,91,290,428,191,345,584,562,590,40,91,216,366,255,317,269,330,423,337,327,886,370,229,38,81,523,540,199,418,546,216,460,303,284,348,295,234,191,353,60,224,136,414,272,347,272,342,771,1019,1041,1042,170,277,604,606,607,836,938,940,403,241,836,926,950,917,191,56,216,60,314,466,489,257,354,447,253,288,402,47,61,187,6,174,274,293,44,172,253,459,319,322,391,450,201,203,365,442,444,338,341,661,738,740,759,368,424,257,460,456,187,528,529,38,75,336,237,238,190,89,224,67,248,179,313,317,413,589,636,658,303,336,437,507,504,191,423,499,202,152,151,242,169,270,393,173,192,7,403,519,365,366,17,312,315,330,463,331,245,326,382,464,469,76,325,466,466,241,243,246,386,434,128,444,531,243,292,174,68,356,415,420,180,481,491,326,341,356,65,325,309,309,78,197,471,470,74,188,7,225,429,162,162,223,211,371,439,540,130,223,303,332,394,205,334,99,99,152,367,401,419,199,7,333,355,256,318,179,179,184,260,75,366,327,329,35,59,178,296,320,399,500,192,198,510,510,75,321,325,346,350,351,342,359,183,291,302,186,327,387,256,319,255,452,301,301,120,75,138,182,49,244,408,408,243,344,65,196,492,496,448,541,607,609,201,259,277,328,302,302,170,174,165,175,325,25,301,333,408,486,180,232,435,435,311,376,377,167,272,188,76,257,455,457,351,97,400,419,443,246,321,343,346,245,315,367,559,139,226,186,345,345,230,249,462,465,235,332,333,92,352,296,349,247,317,199,194,321,342,169,302,369,396,394,457,224,318,340,147,259,348,198,318,339,187,232,269,485,487,338,428,277,487,486,190,77,83,246,276,481,68,208,219,220,101,217,66,186,64,343,316,316,280,360,302,396,698,717,98,74,170,355,429,518,519,348,132,676,679,254,347,348,343,223,177,271,43,113,203,95,184,121,428,101,333,352,210,210,66,556,627,630,339,339,353,353,337,338,367,351,355,335,496,235,331,407,515,516,520,218,352,548,547,174,437,466,292,395,351,363,280,363,216,352,298,415,652,699,702,254,28,264,364,365,281,353,387,330,339,481,147,150,238,137,485,583,111,206,417,275,285,385,371,282,514,220,666,671,669,464,514,516,519,372,374,338,192,189,285,401,401,459,463,207,178,280,336,440,582,217,254,348,333,335,191,389,343,383,439,320,433,533,535,533,582,317,465,470,333,434,498,646,694,786,300,282,199,392,494,234,342,295,338,209,403,502,502,385,240,373,511,518,416,518,234,473,477,267,366,383,434,363,267,268,367,379,263,272,69,223,384,481,485,422,422,520,272,363,423,516,520,233,368,371,268,470,485,257,271,326,85,340,341,341,394,161,319,418,219,230,390,392,495,285,96,399,494,469,518,286,334,219,353,314,301,452,160,257,285,286,223,316,233,332,136,384,385,441,566,566,663,667,223,391,391,279,326,425,196,192,342,492,213,325,326,424,373,609,273,524,625,623,210,345,427,320,288,485,584,202,391,198,387,486,224,419,418,512,614,665,186,587,589,593,788,212,296,445,204,205,336,136,504,503,603,603,209,19,369,207,187,317,366,187,412,417,616,114,114,49,169,267,465,466,562,209,153,215,195,366,369,371,205,134,339,340,311,314,285,292,383,485,499,189,384,436,200,224,225,228,319,347,231,293,70,269,272,80,111,114,208,413,511,202,129,219,179,413,473,195,195,335,336,139,140,251,133,228,69,252,351,386,461,464,197,263,263,98,183,426,315,315,189,124,710,809,873,880,361,501,268,346,96,176,254,132,152,346,264,365,236,348,70,101,330,342,190,159,372,288,286,368,100,358,93,274,339,425,512,140,254,264,290,365,367,161,356,168,966,968,972,288,186,427,231,329,198,262,306,396,480,579,583,308,368,205,198,249,206,265,359,207,266,103,123,320,419,470,514,594,217,759,807,968,359,972,458,419,409,338,414,429,290,247,479,290,181,409,96,347,409,281,330,278,377,292,293,307,351,268,229,347,54,87,663,674,291,373,20,266,27,325,425,22,23,6,323,364,307,450,447,250,45,67,328,328,222,332,327,373,413,125,221,157,314,316,490,563,565,286,313,273,356,121,227,347,261,266,192,310]}
'''
#%%
# Lots of samples with
#  - parallel sentiment classification, chunksize=32
#  - printing disabled

stats = '''
{"numInflight":0,"nosugg":[44,64,74,33,62,120,28,46,47,64,27,61,260,36,60,31,51,93,63,83,55,85,50,30,58,62,30,145,102,30,138,87,33,54,227,146,61,66,50,53,47,84,123,87,54,99,40,85,135,80,77,68,106,94,275,146,242,38,81,340,36,80,37,82,73,58,111,66,112,62,110,28,50,58,147,30,55,28,78,30,51,39,57,86,122,95,131,29,47,130,26,62,33,51,146,42,28,58,83,29,47,27,52,29,47,108,26,42,121,121,29,63,29,48,89,159,29,47,31,51,43,58,40,60,41,48,53,113,73,128,111,199,83,293,141,4,4,2,2,3,25,61,58,28,67,47,74,31,56,40,70,46,63,211,73,33,53,45,85,26,24,52,34,63,27,44,70,51,65,47,98,46,64,51,53,113,81,77,45,83,183,179,104,99,107,64,67,104,75,81,230,79,82,183,529,78,122,52,95,77,73,70,51,61,77,23,64,80,63,71,37,83,53,50,221,69,52,230,65,48,88,193,279,237,195,176,49,4,41,37,42,4,188,73,69,66,37,143,85,63,59,214,199,67,112,59,65,54,83,40,85,84,93,65,67,81,126,101,76,78,135,177,31],"diverse":[370,433,160,470,241,232,364,162,308,236,393,189,168,268,451,155,398,359,376,203,158,280,233,141,304,240,153,144,285,122,121,258,432,88,172,9,8,141,140,151,150,7,161,173,456,224,155,296,141,278,132,282,55,286,227,400,96,236,322,175,317,149,284,270,322,153,287,45,168,255,271,430,266,126,254,189,279,151,209,268,48,47,143,273,6,34,156,369,104,232,132,177,163,66,109,160,151,290,291,162,166,266,303,167,330,372,178,294,342,141,176,255,280,422,423,131,129,140,233,28,25,91,236,108,32,63,263,403,40,128,212,184,274,233,140,285,263,98,228,173,459,18,17,34,53,249,281,279,360,241,175,219,147,298,449,181,225,35,171,170,313,146,278,142,272,408,343,156,462,538,468,114,210,102,158,148,274,35,292,363,171,75,324,371,291,659,156,298,169,315,127,271,360,149,285,177,141,263,268,537,260,326,133,256,252,153,287,125,200,136,260,186,424,138,156,382,162,275,168,143,368,155,285,133,373,140,282,257,261,369,243,471,51,151,214,161,303,155,379,155,143,399,160,182,404,119,63,67,135,139,459,141,138,174,319,171,169,208,163,233,304,249,292,195,62,105,138,183,220,84,223,45,80,245,739,743,310,355,182,274,142,294,231,272,59,204,238,281,344,437,140,205,306,394,273,175,126,295,409,210,200,302,296,250,132,257,269,491,83,183,109,129,41,177,122,244,164,416,261,115,165,104,240,170,323,278,475,206,193,342,258,302,93,230,590,617,334,262,307,181,185,128,183,162,311,504,341,162,161,200,198,254,337,381,793,403,532,184,217,171,314,450,56,61,328,288,333,310,372,256,145,333,106,444,233,41,149,164,346,124,259,361,416,219,349,296,444,585,197,247,155,398,380,202,202,151,184,140,183,204,283,70,67,47,59,141,286,152,189,159,154,146,142,22,161,282,322,309,355,287,325,130,289,7,6],"match":[144,491,374,327,355,312,499,667,364,311,145,274,12,8,6,124,165,141,270,71,122,380,127,236,360,257,137,275,467,169,147,287,154,143,284,53,150,118,242,118,251,171,299,283,128,262,123,289,148,313,98,131,278,141,272,358,334,547,176,148,178,147,270,142,280,143,396,266,261,406,34,147,132,267,146,302,147,276,249,191,491,260,241,202,382,144,156,293,203,141,184,239,195,301,661,426,173,299,159,301,233,148,291,249,197,398,128,298,300,245,269,391,244,275,319,133,190,366,152,299,172,299,164,298,183,299,250,557,464,156,315,238,409,257,289,221,567,541,350,431,165,142,295,153,393,248,97,131,236,140,280,172,297,64,77,123,170,151,275,153,155,294,178,124,266,114,161,143,479,225,39,172,38,55,126,261,275,137,65,15,289,286,426,119,232,35,52,142,267,128,261,47,165,140,115,272,234,157,274,142,271,142,244,278,191,246,280,152,285,115,241,176,304,141,256,135,163,385,201,125,260,239,189,139,348,145,137,275,144,175,303,141,366,253,257,212,418,474,147,112,146,134,223,142,287,118,177,48,79,139,272,133,262,152,131,328,51,176,126,250,275,183,547,292,177,302,46,74,127,267,4,4,4,4,3,31,68,134,262,112,168,340,340,386,223,191,196,225,256,126,263,330,218,262,244,251,196,248,109,162,254,192,189,175,174,319,196,423,180,181,267,312,332,146,191,139,486,382,348,57,190,174,272,52,88,146,233,317,158,251,259,304,486,447,531,332,272,310,196,151,284,203,139,332,60,125,265,202,247,118,293,150,399,221,233,289,96,140,251,198,147,175,346,344,79,124,195,375,181,362,166,211,52,97,391,364,200,486,114,245,177,288,261,427,238,316,280,324,230,273,378,313,268,275,114,282,146,290,68,113,150,400,259,245,234,314,171,306,227,307,222,277,239,244,385,260,266,285,290,259,415,653,390,367,243,238,319,172,309,186,472,207,175,318,237,282,111,158,291,177,315,164,108,182,188,143,283,144,259,145,286,154,128,273,48,72,292,588,519,789,261,391,143,153,257,386,168,138,193,147,190,179,295,13,154,294,128,256,38,176,128,245,149,280,32,55,216,202,352,129,381,169,131,367,141,288,152,295,42,176,130,382,207,143,279,135,231,143,294,127,235,158,136,252,364,177,139,52,115,135,255,317,431,50,68,24,149,275,221,269,592,319,254,217,385,150,122,297,132,260,144,273,149,384,125,215,355,204,179,156,308,144,369,378,127,299,201,140,442,411,194,244,277,550,177,162,294,154,272,366,327,312,130,228,149,291,108,237,256,247,274,99,137,144,299,157,201,55,82,141,310,6,31,37,62,7,39,125,233,156,47,155,293,194,345,247,357,122,133,260,37,160,128,247,139,267,68,27,100,131,384,242,231,388,239,122,163,230,42,81,172,95,296,116,230,237,27,53,43,65,34,61,53,138,475,331,33,158,156,278,144,311,259,361,149,276,96,24,139,139,365,34,72,128,263,75,151,286,306,151,138,269,146,261,185,331,254,173,156,165,147,175,147,373,220,274,232,189,441,131,260,136,270,130,258,320,353,310,148,274,241,293,256,291,91,231,277,158,521,219,274,210,295,135,286,151,295,283,298,294,618,249,290,635,585,360,157,297,143,380,274,170,315,203,156,354,337,196,173,216,296,282,277,427,22,156,190,187,209,277,357,274,276,418,213,278,601,582,682,68,107,219,232,420,159,147,293,67,112,196,240,237,149,284,152,219,301,172,168,110,154,182,136,280,250,287,375,312,499,722,343,297,329,142,249,185,183,142,385,239,98,97,226,280,356,174,155,278,240,344,288,389,232,302,272,399,158,303,304,166,263,164,209,296,303,657,420,156,226,72,215,241,273,420,141,404,60,83,167,227,52,74,145,272,145,319,160,283,143,239,208,380,53,203,43,160,57,82,137,122,282,155,150,155,280,172,306,397,130,267,5,38,64,137,267,138,375,225,28,56,166,253,392,110,221,372,242,218,542,177,7,36,138,286,141,140,277,136,293,159,246,46,186,159,324,99,229,165,140,273,160,114,262,142,269,128,276,172,310,120,260,152,169,298,135,277,191,226,36,165,42,121,233,132,254,255,35,179,34,170,198,195,175,273,257,175,420,218,218,121,304,142,221,314,242,328,316,310,407,276,72,118,259,124,121,150,359,313,159,612,488,705,323,96,100,255,296,249,294,264,309,387,348,432,260,305,295,481,477,315,242,265,267,216,300,143,190,173,328,299,837,750,699,781,693,300,284,333,540,501,589,179,180,76,222,164,411,153,138,228,188,146,285,167,311,212,255,157,133,307,247,338,178,159,299,173,356,154,287,149,407,175,83,163,164,551,324,221,196,323,50,203,200,144,196,206,254,258,398,243,423,197,53,83,65,61,179,325,247,395,482,147,384,217,310,142,289,162,206,44,40,148,435,220,220,200,350,190,621,217,316,332,159,404,150,340,53,332,288,44,79,180,173,356,227,390,443,689,242,300,365,488,62,201,68,164,184,619,497,322,198,50,195,191,329,424,392,573,230,313,165,404,318,180,368,147,286,56,157,302,250,296,241,429,206,224,310,143,286,175,219,175,225,6,56,252,541,414,409,454,323,369,140,169,195,444,252,339,476,207,183,375,163,303,42,195,153,296,201,157,210,250,295,186,276,228,263,20,58,281,311,420,501,146,291,138,283,179,328,285,317,493,560,161,405,170,6,141,11,9,211,303,165,309,45,223,265,369,29,28,176,322,167,177,324,116,164,129,211,234,273,161,255,210,361,308,55,63,185,162,224,60,105,186,325,237,299,101,194,313,367]}
'''
#%%
import pandas as pd
statsx = pd.DataFrame([dict(type=typ, val=val) for typ, vals in json.loads(stats).items() if isinstance(vals, list) for val in vals])
print(len(statsx))
import seaborn as sns
sns.violinplot(x='type', y='val', data=statsx)
statsx.groupby('type').describe()
#%%
statsx.groupby('type').sem()